<div class="outgoing-checks-container">
  <!-- Header -->
  <header class="page-header">
    <div class="header-content">
      <div class="header-left">
        <button class="back-btn" (click)="goBackToDashboard()">
          ← חזרה ללובי
        </button>
      </div>
      <div class="header-center">
        <h1>שיקים יוצאים</h1>
        <p>כל התשלומים לספקים</p>
      </div>
      <div class="header-right">
        <button class="create-btn" (click)="navigateToCreateCheck()">
          ✏️ צור שק חדש
        </button>
      </div>
    </div>
  </header>

  <!-- Filters -->
  <div class="filters-section">
    <div class="filters-row">
      <div class="filter-group">
        <label>סטטוס:</label>
        <select [(ngModel)]="filters.status" (change)="applyFilters()">
          <option *ngFor="let status of statuses" [value]="status.value">
            {{ status.label }}
          </option>
        </select>
      </div>
      
      <div class="filter-group">
        <label>תקופה:</label>
        <select [(ngModel)]="filters.start_date" (change)="applyFilters()">
          <option value="">כל התקופות</option>
          <option *ngFor="let range of dateRanges" [value]="range.value">
            {{ range.label }}
          </option>
        </select>
      </div>
      
      <div class="filter-group">
        <label>מינימום סכום:</label>
        <input type="number" [(ngModel)]="filters.min_amount" (change)="applyFilters()" placeholder="0">
      </div>
      
      <div class="filter-group">
        <label>מקסימום סכום:</label>
        <input type="number" [(ngModel)]="filters.max_amount" (change)="applyFilters()" placeholder="999999">
      </div>
      
      <div class="filter-actions">
        <button class="search-btn" (click)="applyFilters()">
          🔍 חפש
        </button>
        <button class="clear-btn" (click)="clearFilters()">
          נקה פילטרים
        </button>
      </div>
    </div>
  </div>

  <!-- Loading State -->
  <div class="loading-container" *ngIf="loading">
    <div class="loading-spinner"></div>
    <p>טוען שקים יוצאים...</p>
  </div>

  <!-- Error State -->
  <div class="error-container" *ngIf="error">
    <div class="error-message">
      <span class="error-icon">⚠️</span>
      <p>{{ error }}</p>
      <button class="retry-btn" (click)="loadChecks()">נסה שוב</button>
    </div>
  </div>

  <!-- Checks Table -->
  <div class="table-container" *ngIf="!loading && !error">
    <table class="checks-table">
      <thead>
        <tr>
          <th>תאריך פירעון</th>
          <th>סכום</th>
          <th>שם המוטב</th>
          <th>סטטוס</th>
          <th>סימונים</th>
        </tr>
      </thead>
      <tbody>
        <tr 
          *ngFor="let check of checks" 
          class="check-row"
          [ngClass]="getRowClass(check)"
          (click)="openCheckModal(check)">
          <td class="due-date">{{ formatDate(check.due_date) }}</td>
          <td class="amount">{{ formatAmount(check.amount) }}</td>
          <td class="payee-name">{{ check.payee_name || 'לא זמין' }}</td>
          <td class="status">
            <span class="status-badge" [ngClass]="getStatusClass(check.status)">
              {{ getStatusLabel(check.status) }}
            </span>
          </td>
          <td class="marks">
            <span *ngFor="let mark of getCheckMarks(check); let last = last">
              {{ mark }}<span *ngIf="!last"> · </span>
            </span>
          </td>
        </tr>
      </tbody>
    </table>

    <!-- No Data -->
    <div class="no-data" *ngIf="checks.length === 0">
      <div class="no-data-icon">📋</div>
      <h3>לא נמצאו שקים יוצאים</h3>
      <p>אין שקים יוצאים התואמים לפילטרים שנבחרו</p>
      <button class="create-btn" (click)="navigateToCreateCheck()">
        צור שק יוצא ראשון
      </button>
    </div>
  </div>

  <!-- Check Details Modal -->
  <div class="modal-overlay" *ngIf="showModal" (click)="closeModal()">
    <div class="modal-content" (click)="$event.stopPropagation()">
      <div class="modal-header">
        <h2>פרטי שק יוצא</h2>
        <button class="close-btn" (click)="closeModal()">×</button>
      </div>
      
      <div class="modal-body" *ngIf="selectedCheck">
        <!-- Check Visual -->
        <div class="check-visual">
          <div class="check-header">
            <div class="bank-name">שק בנק</div>
            <div class="bank-name-en">Bank Check</div>
          </div>
          
          <div class="check-details">
            <div class="check-field">
              <label>בנק:</label>
              <span>{{ selectedCheck.bank_name || 'הפועלים' }}</span>
            </div>
            <div class="check-field">
              <label>סניף:</label>
              <span>{{ selectedCheck.bank_branch || '123' }}</span>
            </div>
            <div class="check-field">
              <label>תאריך:</label>
              <span>{{ formatDate(selectedCheck.due_date) }}</span>
            </div>
            <div class="check-field">
              <label>שלם לפי הוראת:</label>
              <span class="payee-name-large">{{ selectedCheck.payee_name || 'לא זמין' }}</span>
            </div>
            <div class="amount-section">
              <div class="amount-label">סכום:</div>
              <div class="amount-value">{{ formatAmount(selectedCheck.amount) }}</div>
            </div>
            <div class="check-field">
              <label>מספר שק:</label>
              <span>{{ selectedCheck.check_number }}</span>
            </div>
            <div class="check-type">
              <span class="type-badge" [ngClass]="selectedCheck.is_physical ? 'physical' : 'digital'">
                {{ selectedCheck.is_physical ? '📄 שק פיזי' : '💻 שק דיגיטלי' }}
              </span>
            </div>
          </div>
        </div>

        <!-- Actions -->
        <div class="modal-actions">
          <h3>פעולות</h3>
          
          <button class="action-btn cancel-btn" (click)="cancelCheck()">
            🚫 ביטול שק
          </button>
          
          <button class="action-btn print-btn" (click)="printCheck()">
            🖨️ הדפסה
          </button>
          
          <button class="action-btn duplicate-btn" (click)="duplicateCheck()">
            📋 שכפול שק
          </button>
          
          <button class="action-btn close-btn" (click)="closeModal()">
            סגור
          </button>
        </div>
      </div>
    </div>
  </div>
</div>