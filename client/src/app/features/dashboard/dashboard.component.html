<div class="dashboard-container">
  <!-- Header -->
  <header class="dashboard-header">
    <div class="header-content">
      <div class="logo-section">
        <h1 class="main-title">ניהול שקים</h1>
        <div class="divider"></div>
        <div class="discount-logo">דיסקונט</div>
      </div>
      
      <div class="header-actions">
        <button class="icon-btn" title="חיפוש">
          <span class="icon">🔍</span>
        </button>
        <button class="icon-btn notification-btn" title="התראות">
          <span class="icon">🔔</span>
          <span class="notification-dot"></span>
        </button>
        <button class="icon-btn notification-btn" title="הודעות">
          <span class="icon">📧</span>
          <span class="notification-dot"></span>
        </button>
        <button class="icon-btn" title="הגדרות">
          <span class="icon">⚙️</span>
        </button>
        <button class="icon-btn" title="נגישות">
          <span class="icon">♿</span>
        </button>
        <button class="icon-btn" title="שירות לקוחות">
          <span class="icon">💬</span>
        </button>
        <button class="logout-btn" (click)="logout()">
          יציאה ←
        </button>
      </div>
    </div>
  </header>

  <div class="dashboard-layout">
    <!-- Sidebar -->
    <aside class="sidebar">
      <div class="sidebar-content">
        <!-- מידע -->
        <div class="menu-category">
          <div class="category-header">מידע</div>
          <div class="menu-item active" (click)="navigateToDashboard()">
            <span class="menu-icon">🏠</span>
            <span class="menu-text">לובי שקים</span>
          </div>
          <div class="menu-item" (click)="navigateToIncomingChecks()">
            <span class="menu-icon">📥</span>
            <span class="menu-text">שקים נכנסים</span>
          </div>
          <div class="menu-item" (click)="navigateToOutgoingChecks()">
            <span class="menu-icon">📤</span>
            <span class="menu-text">שקים יוצאים</span>
          </div>
        </div>

        <!-- פעולות -->
        <div class="menu-category">
          <div class="category-header">פעולות</div>
          <div class="menu-item" (click)="navigateToCreateCheck()">
            <span class="menu-icon">✏️</span>
            <span class="menu-text">כתיבת שיק דיגיטלי חדש</span>
          </div>
          <div class="menu-item">
            <span class="menu-icon">📋</span>
            <span class="menu-text">חומת פנקסי שיקים</span>
          </div>
          <div class="menu-item">
            <span class="menu-icon">🔄</span>
            <span class="menu-text">הפעלה פנקסי שיקים</span>
          </div>
          <div class="menu-item">
            <span class="menu-icon">❌</span>
            <span class="menu-text">ביטול פנקסי שיקים שהוזמנו</span>
          </div>
          <div class="menu-item">
            <span class="menu-icon">🚫</span>
            <span class="menu-text">ביטול שיקים</span>
          </div>
          <div class="menu-item">
            <span class="menu-icon">📊</span>
            <span class="menu-text">משיכת שיקים דחויים</span>
          </div>
        </div>
      </div>
    </aside>

    <!-- Main Content -->
    <main class="main-content">
      <!-- Account Selector -->
      <div class="account-selector">
        <div class="account-info">
          <div class="account-dropdown">
            <select class="account-select">
              <option value="1">0136816225 פמח דבור קק בע"מ</option>
            </select>
          </div>
          <div class="balance-info">
            <div class="balance-label">יתרה כוללת (תעודות כולל מנגנון)</div>
            <div class="balance-amount">1,060,685,996.00 ₪</div>
            <a href="#" class="credit-link">מסגרת אשראי</a>
          </div>
        </div>
      </div>

      <!-- Filters Bar -->
      <div class="filters-bar">
        <div class="filter-left">
          <button class="filter-btn active">פירוט</button>
          <button class="filter-btn">ריכוז</button>
        </div>
        <div class="filter-right">
          <button class="filter-btn secondary">
            <span class="icon">🔍</span>
            חיפוש מתקדם
          </button>
          <button class="filter-btn primary">
            <span class="icon">📥</span>
            שמירה והדפסה
          </button>
        </div>
      </div>

      <!-- Loading State -->
      <div class="loading-container" *ngIf="isLoading">
        <div class="loading-spinner"></div>
        <p>טוען נתוני דשבורד...</p>
      </div>

      <!-- Error State -->
      <div class="error-container" *ngIf="error">
        <div class="error-message">
          <span class="error-icon">⚠️</span>
          <p>{{ error }}</p>
          <button class="retry-btn" (click)="loadDashboardStats()">נסה שוב</button>
        </div>
      </div>

      <!-- Dashboard Content -->
      <div class="dashboard-content" *ngIf="!isLoading && !error">
        <!-- Outgoing Checks Section -->
        <section class="checks-section">
          <div class="section-header" (click)="navigateToOutgoingChecks()">
            <div class="section-title">
              <div class="title-line red"></div>
              <h2>שיקים יוצאים</h2>
              <span class="arrow">→</span>
            </div>
            <p class="section-subtitle">(תשלומים לספקים)</p>
          </div>

          <div class="stats-grid">
            <!-- סה״כ פתוחים -->
            <div class="stat-card pending">
              <div class="stat-icon">⏰</div>
              <div class="stat-content">
                <div class="stat-value">{{ formatCurrency(stats.outgoing.total_amount) }}</div>
                <div class="stat-label">{{ formatNumber(stats.outgoing.pending_count) }} שקים</div>
              </div>
            </div>

            <!-- מגיעים השבוע -->
            <div class="stat-card warning">
              <div class="stat-icon">⚠️</div>
              <div class="stat-content">
                <div class="stat-value">{{ formatNumber(stats.outgoing.due_this_week) }}</div>
                <div class="stat-label">דורשים תשומת לב</div>
              </div>
            </div>

            <!-- מגיעים החודש -->
            <div class="stat-card info">
              <div class="stat-icon">📅</div>
              <div class="stat-content">
                <div class="stat-value">{{ formatNumber(stats.outgoing.due_this_month) }}</div>
                <div class="stat-label">תזרים צפוי</div>
              </div>
            </div>

            <!-- שקים שחזרו -->
            <div class="stat-card danger">
              <div class="stat-icon">❌</div>
              <div class="stat-content">
                <div class="stat-value">{{ formatNumber(stats.outgoing.bounced_count) }}</div>
                <div class="stat-label">דורש טיפול</div>
              </div>
            </div>
          </div>

          <!-- Pie Chart for Outgoing -->
          <div class="chart-container">
            <h3>חלוקת סטטוסים - שקים יוצאים</h3>
            <div class="pie-chart">
              <div class="chart-center">
                <div class="center-number">{{ formatNumber(stats.outgoing.pending_count + 20) }} סה״כ</div>
              </div>
              <div class="chart-legend">
                <div class="legend-item">
                  <div class="legend-color pending"></div>
                  <span>ממתין לפירעון 28%</span>
                </div>
                <div class="legend-item">
                  <div class="legend-color cleared"></div>
                  <span>נפרע 69%</span>
                </div>
                <div class="legend-item">
                  <div class="legend-color bounced"></div>
                  <span>נדחה 3%</span>
                </div>
              </div>
            </div>
          </div>
        </section>

        <!-- Incoming Checks Section -->
        <section class="checks-section">
          <div class="section-header" (click)="navigateToIncomingChecks()">
            <div class="section-title">
              <div class="title-line green"></div>
              <h2>שיקים נכנסים</h2>
              <span class="arrow">→</span>
            </div>
            <p class="section-subtitle">(תשלומים מלקוחות)</p>
          </div>

          <div class="stats-grid">
            <!-- ממתינים להפקדה -->
            <div class="stat-card success">
              <div class="stat-icon">📋</div>
              <div class="stat-content">
                <div class="stat-value">{{ formatCurrency(stats.incoming.waiting_deposit_amount) }}</div>
                <div class="stat-label">{{ formatNumber(stats.incoming.waiting_deposit_count) }} שקים</div>
              </div>
            </div>

            <!-- הופקדו -->
            <div class="stat-card purple">
              <div class="stat-icon">📈</div>
              <div class="stat-content">
                <div class="stat-value">{{ formatNumber(stats.incoming.deposited_count) }}</div>
                <div class="stat-label">ממתינים לפירעון</div>
              </div>
            </div>

            <!-- נפרעו -->
            <div class="stat-card success">
              <div class="stat-icon">✅</div>
              <div class="stat-content">
                <div class="stat-value">{{ formatNumber(stats.incoming.cleared_count) }}</div>
                <div class="stat-label">כבר בחשבון</div>
              </div>
            </div>

            <!-- שקים שחזרו -->
            <div class="stat-card danger">
              <div class="stat-icon">❌</div>
              <div class="stat-content">
                <div class="stat-value">{{ formatNumber(stats.incoming.bounced_count) }}</div>
                <div class="stat-label">דורש טיפול</div>
              </div>
            </div>
          </div>

          <!-- Pie Chart for Incoming -->
          <div class="chart-container">
            <h3>חלוקת סטטוסים - שקים נכנסים</h3>
            <div class="pie-chart">
              <div class="chart-center">
                <div class="center-number">{{ formatNumber(stats.incoming.waiting_deposit_count + stats.incoming.deposited_count + stats.incoming.cleared_count) }} סה״כ</div>
              </div>
              <div class="chart-legend">
                <div class="legend-item">
                  <div class="legend-color waiting"></div>
                  <span>ממתין להפקדה 16%</span>
                </div>
                <div class="legend-item">
                  <div class="legend-color deposited"></div>
                  <span>הופקד 11%</span>
                </div>
                <div class="legend-item">
                  <div class="legend-color cleared"></div>
                  <span>נפרע 71%</span>
                </div>
                <div class="legend-item">
                  <div class="legend-color bounced"></div>
                  <span>נדחה 2%</span>
                </div>
              </div>
            </div>
          </div>
        </section>
      </div>
    </main>
  </div>
</div>
